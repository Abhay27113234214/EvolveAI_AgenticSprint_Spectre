<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Documents - Spectre</title>
    <meta name="description" content="Upload your financial documents (PDF, Excel) for AI-powered analysis and insights.">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="layout-sidebar">
    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main Navigation">
        <div class="container">
            <a href="{{ url_for('index') }}" class="navbar-brand" aria-label="Spectre Home">
                Spectre
            </a>
            <ul class="navbar-nav">
                <li><a href="{{ url_for('index') }}">Home</a></li>
                <li><a href="{{ url_for('dashboard') }}">Dashboard</a></li>
                <li><a href="{{ url_for('uploadAnnualPdf') }}" class="active" aria-current="page">Upload</a></li>
                <li><a href="{{ url_for('index') }}#risks">Risks</a></li>
                <li><a href="{{ url_for('dashboard') }}#insights">Insights</a></li>
                <li><a href="{{ url_for('dashboard') }}#monitoring">Monitoring</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content upload">
        <div class="container">
            <!-- Page Header -->
            <section class="text-center mb-xl" aria-labelledby="upload-title">
                <h1 id="upload-title">Upload Financial Documents</h1>
                <p class="mb-lg" style="max-width: 600px; margin: 0 auto; color: var(--text-secondary);">
                    Upload your PDF and Excel files containing financial data. Our AI will automatically 
                    process and analyze your documents to provide comprehensive insights.
                </p>
            </section>

            <!-- Upload Form -->
            <section class="mb-xl">
                <div class="card" style="max-width: 800px; margin: 0 auto;">
                    <div class="card-header">
                        <h2 class="card-title mb-0">Document Upload</h2>
                    </div>
                    <div class="card-body">
                        <!-- Upload Instructions -->
                        <div class="alert alert-info mb-lg" style="background-color: rgba(37, 99, 235, 0.1); border-left-color: var(--primary-color); color: var(--primary-color);">
                            <strong>Supported file types:</strong> PDF, Excel (.xlsx, .xls)<br>
                            <strong>Maximum file size:</strong> 10MB per file<br>
                            <strong>Multiple files:</strong> You can upload multiple documents at once
                        </div>

                        <!-- File Upload Area -->
                        <form id="uploadForm" enctype="multipart/form-data" novalidate method="POST" action="{{ url_for('uploadAnnualPdf') }}">
                            <div class="form-group">
                                <label for="fileInput" class="form-label">
                                    Select Financial Documents
                                    <span class="sr-only">(PDF or Excel files)</span>
                                </label>
                                
                                <!-- Drag & Drop Area -->
                                <div class="file-upload-area" id="uploadArea" 
                                     role="button" 
                                     tabindex="0" 
                                     aria-describedby="upload-instructions">
                                    
                                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: var(--space-md);" aria-hidden="true">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                        <polyline points="17,8 12,3 7,8"/>
                                        <line x1="12" y1="3" x2="12" y2="15"/>
                                    </svg>
                                    
                                    <h3 style="margin-bottom: var(--space-sm);">Drag & drop files here</h3>
                                    <p style="color: var(--text-muted); margin-bottom: var(--space-lg);" id="upload-instructions">
                                        or click to select files from your computer
                                    </p>
                                    
                                    <input type="file" 
                                           id="fileInput" 
                                           name="pdf_file" 
                                           accept=".pdf" 
                                           class="sr-only">
                                    
                                    <button type="button" 
                                            id="selectFilesBtn"
                                            class="btn btn-primary" 
                                            aria-label="Select files to upload">
                                        Select Files
                                    </button>
                                </div>
                            </div>

                            <!-- Selected Files Display -->
                            <div id="selectedFiles" class="d-none">
                                <h4>Selected Files</h4>
                                <div id="filesList" role="list"></div>
                            </div>

                            <!-- Upload Progress -->
                            <div id="uploadProgress" class="d-none">
                                <h4>Upload Progress</h4>
                                <div class="progress mb-md">
                                    <div class="progress-bar" id="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" style="width: 0%"></div>
                                </div>
                                <p id="progressText" class="text-center">Preparing upload...</p>
                            </div>

                            <!-- Upload Button -->
                            <div class="text-center mt-lg">
                                <button type="submit" 
                                        class="btn btn-primary btn-lg" 
                                        id="uploadButton" 
                                        
                                        aria-describedby="upload-status">
                                    <span class="spinner d-none" aria-hidden="true"></span>
                                    Upload Documents
                                </button>
                            </div>

                            <!-- Status Messages -->
                            <div id="uploadStatus" aria-live="polite" aria-atomic="true"></div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Upload History -->
            <section>
                <div class="card" style="max-width: 800px; margin: 0 auto;">
                    <div class="card-header">
                        <h2 class="card-title mb-0">Recent Uploads</h2>
                    </div>
                    <div class="card-body">
                        <div id="uploadHistory">
                            <p class="text-center" style="color: var(--text-muted); padding: var(--space-xl) 0;">
                                No documents uploaded yet. Upload your first financial document to get started.
                            </p>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Success Modal (Simple) -->
    <div id="successModal" class="d-none" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; display: none;" aria-hidden="true" role="dialog" aria-labelledby="success-title">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--bg-card); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); max-width: 500px; width: 90%;">
            <div class="card-body text-center">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--success-color)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: var(--space-lg);" aria-hidden="true">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22,4 12,14.01 9,11.01"/>
                </svg>
                <h2 id="success-title" class="card-title">Upload Successful!</h2>
                <p class="card-text mb-lg">
                    Your documents have been successfully uploaded and are being processed by our AI. 
                    You can now view the analysis in the dashboard.
                </p>
                <div class="d-flex" style="justify-content: center; gap: var(--space-md);">
                    <button id="viewDashboardBtn" class="btn btn-primary">
                        View Dashboard
                    </button>
                    <button id="uploadMoreBtn" class="btn btn-secondary">
                        Upload More
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/utils.js" defer></script>
    <script src="app.js" defer></script>
</body>
</html>